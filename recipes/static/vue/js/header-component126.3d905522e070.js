"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[933,678,80],{46768:function(t,e,i){i.r(e);var s=i(64400),a=i(44302),n=i(1001),r=(0,n.Z)(a.Z,s.s,s.x,!1,null,null,null);e["default"]=r.exports},51523:function(t,e,i){i.r(e);var s=i(81647),a=i(96062),n=i(1001),r=(0,n.Z)(a.Z,s.s,s.x,!1,null,null,null);e["default"]=r.exports},53686:function(t,e,i){i.r(e);var s=i(17789),a=i(48584),n=i(1001),r=(0,n.Z)(a.Z,s.s,s.x,!1,null,null,null);e["default"]=r.exports},44302:function(t,e,i){var s=i(30586);e["Z"]=s.Z},96062:function(t,e,i){var s=i(55233);e["Z"]=s.Z},48584:function(t,e,i){var s=i(34841);e["Z"]=s.Z},64400:function(t,e,i){i.d(e,{s:function(){return s},x:function(){return a}});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i(t.compiled,{tag:"component",attrs:{ingredient_factor:t.ingredient_factor,code:t.code}})],1)},a=[]},81647:function(t,e,i){i.d(e,{s:function(){return s},x:function(){return a}});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{domProps:{innerHTML:t._s(t.calculateAmount(t.number))}})},a=[]},17789:function(t,e,i){i.d(e,{s:function(){return s},x:function(){return a}});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("hr"),t.recipe.steps.length>1?i("div",{staticClass:"row mb-1"},[i("div",{staticClass:"col col-md-8"},[i("h5",{staticClass:"text-primary"},[t.step.name?[t._v(t._s(t.step.name))]:[t._v(t._s(t.$t("Step"))+" "+t._s(t.index+1))],0!==t.step.time?i("small",{staticClass:"text-muted",staticStyle:{"margin-left":"4px"}},[i("i",{staticClass:"fas fa-user-clock"}),t._v(" "+t._s(t.step_time))]):t._e(),""!==t.start_time?i("small",{staticClass:"d-print-none"},[i("b-link",{attrs:{id:"id_reactive_popover_"+t.step.id,href:"#"},on:{click:t.openPopover}},[t._v(" "+t._s(t.moment(t.start_time).add(t.step.time_offset,"minutes").format("HH:mm"))+" ")])],1):t._e()],2)]),i("div",{staticClass:"col col-md-4 text-right"},[i("b-button",{staticClass:"shadow-none d-print-none",class:{"text-primary":t.details_visible,"text-success":!t.details_visible},staticStyle:{border:"none",background:"none"},on:{click:function(e){t.details_visible=!t.details_visible}}},[i("i",{staticClass:"far fa-check-circle"})])],1)]):t._e(),i("b-collapse",{attrs:{id:"collapse-1"},model:{value:t.details_visible,callback:function(e){t.details_visible=e},expression:"details_visible"}},[i("div",{staticClass:"row"},[t.step.ingredients.length>0&&(t.recipe.steps.length>1||t.force_ingredients)?i("div",{staticClass:"col col-md-4"},[i("table",{staticClass:"table table-sm"},[i("ingredients-card",{attrs:{steps:[t.step],ingredient_factor:t.ingredient_factor},on:{"checked-state-changed":function(e){return t.$emit("checked-state-changed",e)}}})],1)]):t._e(),i("div",{staticClass:"col",class:{"col-md-8 col-12":t.recipe.steps.length>1,"col-md-12 col-12":t.recipe.steps.length<=1}},[i("div",{staticClass:"row"},[i("div",{staticClass:"col col-md-12"},[i("compile-component",{attrs:{code:t.step.ingredients_markdown,ingredient_factor:t.ingredient_factor}})],1)]),null!==t.step.file?i("div",{staticClass:"row"},[i("div",{staticClass:"col col-md-12"},[[""!==t.step.file.preview?i("div",[i("b-img",{attrs:{src:t.step.file.preview,"fluid-grow":""}})],1):i("div",[i("a",{attrs:{href:t.step.file.file_download,target:"_blank",rel:"noreferrer nofollow"}},[t._v(t._s(t.$t("Download"))+" "+t._s(t.$t("File")))])])]],2)]):t._e()])]),i("div",{staticClass:"row"},[i("div",{staticClass:"col col-md-12"},[null!==t.step.step_recipe_data?i("div",{staticClass:"card"},[i("b-collapse",{attrs:{id:"collapse-1"},model:{value:t.details_visible,callback:function(e){t.details_visible=e},expression:"details_visible"}},[i("div",{staticClass:"card-body"},[i("h2",{staticClass:"card-title"},[i("a",{attrs:{href:t.resolveDjangoUrl("view_recipe",t.step.step_recipe_data.id)}},[t._v(t._s(t.step.step_recipe_data.name))])]),t._l(t.step.step_recipe_data.steps,(function(e,s){return i("div",{key:"substep_"+e.id},[i("step-component",{attrs:{recipe:t.step.step_recipe_data,step:e,ingredient_factor:t.ingredient_factor,index:s,start_time:t.start_time,force_ingredients:!0}})],1)}))],2)])],1):t._e()])])]),""!==t.start_time?i("div",[i("b-popover",{ref:"id_reactive_popover_"+t.step.id,attrs:{target:"id_reactive_popover_"+t.step.id,triggers:"click",placement:"bottom",title:t.$t("Step start time")}},[i("div",[i("b-form-group",{staticClass:"mb-1",attrs:{label:"Time","label-for":"popover-input-1","label-cols":"3"}},[i("b-form-input",{attrs:{type:"datetime-local",id:"popover-input-1",size:"sm"},model:{value:t.set_time_input,callback:function(e){t.set_time_input=e},expression:"set_time_input"}})],1)],1),i("div",{staticClass:"row",staticStyle:{"margin-top":"1vh"}},[i("div",{staticClass:"col-12",staticStyle:{"text-align":"right"}},[i("b-button",{staticStyle:{"margin-right":"8px"},attrs:{size:"sm",variant:"secondary"},on:{click:t.closePopover}},[t._v(" "+t._s(t.$t("Cancel"))+" ")]),i("b-button",{attrs:{size:"sm",variant:"primary"},on:{click:t.updateTime}},[t._v(t._s(t.$t("Ok")))])],1)])])],1):t._e()],1)},a=[]},30586:function(t,e,i){var s=i(70538),a=i(51523);e["Z"]={name:"CompileComponent",props:["code","ingredient_factor"],data(){return{compiled:null}},mounted(){this.compiled=s["default"].component("compiled-component",{props:["ingredient_factor","code"],components:{ScalableNumber:a["default"]},template:`<div>${this.code}</div>`})}}},55233:function(t,e,i){var s=i(4222);e["Z"]={name:"ScalableNumber",props:{number:Number,factor:{type:Number,default:4}},methods:{calculateAmount:function(t){return(0,s.calculateAmount)(t,this.factor)}}}},34841:function(t,e,i){var s=i(4222),a=i(46768),n=i(21658),r=i(70538),o=i(30381),l=i.n(o);r["default"].prototype.moment=l(),e["Z"]={name:"StepComponent",mixins:[s.GettextMixin,s.ResolveUrlMixin],components:{CompileComponent:a["default"],IngredientsCard:n["default"]},props:{step:Object,ingredient_factor:Number,index:Number,recipe:Object,start_time:String,force_ingredients:{type:Boolean,default:!1}},computed:{step_time:function(){return(0,s.calculateHourMinuteSplit)(this.step.time)}},data(){return{details_visible:!0,set_time_input:""}},mounted(){this.set_time_input=l()(this.start_time).add(this.step.time_offset,"minutes").format("yyyy-MM-DDTHH:mm")},methods:{calculateAmount:function(t){return(0,s.calculateAmount)(t,this.ingredient_factor)},updateTime:function(){let t=l()(this.set_time_input).add(-1*this.step.time_offset,"minutes").format("yyyy-MM-DDTHH:mm");this.$emit("update-start-time",t),this.closePopover()},closePopover:function(){this.$refs[`id_reactive_popover_${this.step.id}`].$emit("close")},openPopover:function(){this.$refs[`id_reactive_popover_${this.step.id}`].$emit("open")}}}}}]);
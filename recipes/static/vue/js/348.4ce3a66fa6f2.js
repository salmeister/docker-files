(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[348],{61348:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return h}});var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("b-modal",{staticClass:"modal",attrs:{id:"id_modal_cook_log_"+e.modal_id,title:e.$t("Log_Recipe_Cooking"),"ok-title":e.$t("Save"),"cancel-title":e.$t("Close")},on:{ok:function(t){return e.logCook()}}},[i("p",[e._v(e._s(e.$t("all_fields_optional")))]),i("form",[i("label",{attrs:{for:"id_log_servings"}},[e._v(e._s(e.$t("Servings")))]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.logObject.servings,expression:"logObject.servings"}],staticClass:"form-control",attrs:{type:"number",id:"id_log_servings"},domProps:{value:e.logObject.servings},on:{input:function(t){t.target.composing||e.$set(e.logObject,"servings",t.target.value)}}}),i("label",{staticStyle:{"margin-top":"2vh"}},[e._v(e._s(e.$t("Rating"))+" - "),i("span",{attrs:{id:"id_rating_show"}},[e._v(e._s(e.logObject.rating)+"/5")])]),i("b-form-rating",{model:{value:e.logObject.rating,callback:function(t){e.$set(e.logObject,"rating",t)},expression:"logObject.rating"}}),i("label",{staticStyle:{"margin-top":"2vh"},attrs:{for:"id_date"}},[e._v(e._s(e.$t("Date")))]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.logObject.created_at,expression:"logObject.created_at"}],staticClass:"form-control",attrs:{type:"datetime-local",id:"id_date"},domProps:{value:e.logObject.created_at},on:{input:function(t){t.target.composing||e.$set(e.logObject,"created_at",t.target.value)}}})],1)])],1)},s=[],n=i(30381),r=i.n(n),o=i(70538),l=i(56738),d=i(57871);o["default"].prototype.moment=r(),o["default"].use(l.XG7);var c={name:"CookLog",props:{recipe:Object,modal_id:Number},data(){return{logObject:{recipe:this.recipe.id,servings:0,rating:0,created_at:r()().format("yyyy-MM-DDTHH:mm")}}},methods:{logCook:function(){(0,d.YI)(this.logObject)}}},p=c,u=i(1001),_=(0,u.Z)(p,a,s,!1,null,null,null),h=_.exports},98985:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return _}});var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("tr",[e.ingredient.is_header?[i("td",{attrs:{colspan:"5"},on:{click:e.done}},[i("b",[e._v(e._s(e.ingredient.note))])])]:[e.detailed?i("td",{staticClass:"d-print-none",on:{click:e.done}},[e.ingredient.checked?i("i",{staticClass:"far fa-check-circle text-success"}):e._e(),e.ingredient.checked?e._e():i("i",{staticClass:"far fa-check-circle text-primary"})]):e._e(),i("td",{staticClass:"text-nowrap",on:{click:e.done}},[0===e.ingredient.amount||e.ingredient.no_amount?e._e():i("span",{domProps:{innerHTML:e._s(e.calculateAmount(e.ingredient.amount))}})]),i("td",{on:{click:e.done}},[null===e.ingredient.unit||e.ingredient.no_amount?e._e():i("span",[e._v(e._s(e.ingredient.unit.name))])]),i("td",{on:{click:e.done}},[null!==e.ingredient.food?[null!==e.ingredient.food.recipe?i("a",{attrs:{href:e.resolveDjangoUrl("view_recipe",e.ingredient.food.recipe.id),target:"_blank",rel:"noopener noreferrer"}},[e._v(e._s(e.ingredient.food.name))]):e._e(),null===e.ingredient.food.recipe?i("span",[e._v(e._s(e.ingredient.food.name))]):e._e()]:e._e()],2),e.detailed?i("td",[e.ingredient.note?i("div",[i("span",{directives:[{name:"b-popover",rawName:"v-b-popover.hover",value:e.ingredient.note,expression:"ingredient.note",modifiers:{hover:!0}}],staticClass:"d-print-none touchable p-0 pl-md-2 pr-md-2"},[i("i",{staticClass:"far fa-comment"})]),i("div",{staticClass:"d-none d-print-block"},[i("i",{staticClass:"far fa-comment-alt d-print-none"}),e._v(" "+e._s(e.ingredient.note)+" ")])]):e._e()]):e._e()]],2)},s=[],n=i(4222),r=i(70538),o=i(65284),l=i.n(o);r["default"].use(l());var d={name:"IngredientComponent",props:{ingredient:Object,ingredient_factor:{type:Number,default:1},detailed:{type:Boolean,default:!0}},mixins:[n.ResolveUrlMixin],data(){return{checked:!1}},watch:{},mounted(){},methods:{calculateAmount:function(e){return this.$sanitize((0,n.calculateAmount)(e,this.ingredient_factor))},done:function(){this.$emit("checked-state-changed",this.ingredient)}}},c=d,p=i(1001),u=(0,p.Z)(c,a,s,!1,null,"4c3d61e0",null),_=u.exports},21658:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return _}});var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:{"card border-primary no-border":e.header}},[i("div",{class:{"card-body":e.header,"p-0":e.header}},[e.header?i("div",{staticClass:"card-header"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-6"},[i("h4",{staticClass:"card-title"},[i("i",{staticClass:"fas fa-pepper-hot"}),e._v(" "+e._s(e.$t("Ingredients")))])])])]):e._e(),i("div",{staticClass:"card-body p-1 p-md-3"},[i("div",{staticClass:"row no-gutter"},[i("div",{staticClass:"col-12 m-0",class:{"p-0":!e.header}},[i("table",{staticClass:"table table-sm mb-0"},[e._l(e.steps,(function(t){return[t.show_as_header&&""!==t.name&&e.steps.length>1?i("tr",{key:t.id},[i("td",{attrs:{colspan:"5"}},[i("b",[e._v(e._s(t.name))])])]):e._e(),e._l(t.ingredients,(function(t){return[i("ingredient-component",{key:t.id,attrs:{ingredient:t,ingredient_factor:e.ingredient_factor,detailed:e.detailed},on:{"checked-state-changed":function(t){return e.$emit("checked-state-changed",t)}}})]}))]}))],2)])])])])])},s=[],n=i(70538),r=i(56738),o=(i(70044),i(98985)),l=i(4222);n["default"].use(r.XG7);var d={name:"IngredientCard",mixins:[l.ApiMixin],components:{IngredientComponent:o["default"]},props:{steps:{type:Array,default(){return[]}},recipe:{type:Number},ingredient_factor:{type:Number,default:1},servings:{type:Number,default:1},detailed:{type:Boolean,default:!0},header:{type:Boolean,default:!1},recipe_list:{type:Number,default:void 0}},data(){return{show_shopping:!1,shopping_list:[],update_shopping:[],selected_shoppingrecipe:void 0}},computed:{ShoppingRecipes(){let e=this.shopping_list.map((e=>({value:e?.list_recipe,text:e?.recipe_mealplan?.name,recipe:e?.recipe_mealplan?.recipe??0,servings:e?.recipe_mealplan?.servings}))).filter((e=>e?.recipe==this.recipe));return[...new Map(e.map((e=>[e["value"],e]))).values()]}},watch:{},mounted(){},methods:{}},c=d,p=i(1001),u=(0,p.Z)(c,a,s,!1,null,null,null),_=u.exports},33144:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return c}});var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.recipe.keywords.length>0?i("div",e._l(e.recipe.keywords.filter((function(e){return e.show||void 0===e.show})),(function(t){return i("span",{key:t.id,staticClass:"pl-1"},[i("a",{attrs:{href:e.resolveDjangoUrl("view_search")+"?keyword="+t.id}},[i("b-badge",{staticClass:"font-weight-normal",attrs:{pill:"",variant:"light"}},[e._v(e._s(t.label))])],1)])})),0):e._e()},s=[],n=i(4222),r={name:"KeywordsComponent",mixins:[n.ResolveUrlMixin],props:{recipe:Object}},o=r,l=i(1001),d=(0,l.Z)(o,a,s,!1,null,null,null),c=d.exports},53559:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return p}});var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[null!==e.recipe.last_cooked?i("span",{staticClass:"pl-1"},[i("b-badge",{staticClass:"font-weight-normal",attrs:{pill:"",variant:"primary"}},[i("i",{staticClass:"fas fa-utensils"}),e._v(" "+e._s(e.formatDate(e.recipe.last_cooked)))])],1):e._e()])},s=[],n=i(30381),r=i.n(n),o={name:"LastCooked",props:{recipe:Object},methods:{formatDate:function(e){return r().locale(window.navigator.language),r()(e).format("L")}}},l=o,d=i(1001),c=(0,d.Z)(l,a,s,!1,null,"379fb2ba",null),p=c.exports},57609:function(e,t,i){"use strict";i.r(t);var a=i(22291),s=i(82093),n=i(1001),r=(0,n.Z)(s.Z,a.s,a.x,!1,null,null,null);t["default"]=r.exports},14551:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return m}});var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("b-modal",{staticClass:"modal",attrs:{id:"id_modal_add_book_"+e.modal_id,title:e.$t("Manage_Books"),"ok-title":e.$t("Add"),"cancel-title":e.$t("Close")},on:{ok:function(t){return e.addToBook()},shown:e.loadBookEntries}},[i("ul",{staticClass:"list-group"},e._l(this.recipe_book_list,(function(t){return i("li",{key:t.id,staticClass:"list-group-item d-flex justify-content-between align-items-center"},[e._v(" "+e._s(t.book_content.name)+" "),i("span",{staticClass:"btn btn-sm btn-danger",on:{click:function(i){return e.removeFromBook(t)}}},[i("i",{staticClass:"fa fa-trash-alt"})])])})),0),i("multiselect",{staticStyle:{"margin-top":"1vh"},attrs:{options:e.books_filtered,taggable:!0,"tag-placeholder":e.$t("Create"),placeholder:e.$t("Select_Book"),label:"name","track-by":"id",id:"id_books",multiple:!1,loading:e.books_loading},on:{tag:e.createBook,"search-change":e.loadBooks},model:{value:e.selected_book,callback:function(t){e.selected_book=t},expression:"selected_book"}})],1)],1)},s=[],n=i(47907),r=i.n(n),o=i(30381),l=i.n(o),d=i(70538),c=i(56738),p=i(70846),u=i(4222);d["default"].prototype.moment=l(),d["default"].use(c.XG7);var _={name:"AddRecipeToBook",components:{Multiselect:r()},props:{recipe:Object,modal_id:Number},data(){return{books:[],books_loading:!1,recipe_book_list:[],selected_book:null}},computed:{books_filtered:function(){let e=[];return this.books.forEach((t=>{0===this.recipe_book_list.filter((e=>e.book===t.id)).length&&e.push(t)})),e}},mounted(){},methods:{loadBooks:function(e){this.books_loading=!0;let t=new p.ApiApiFactory;t.listRecipeBooks({query:{query:e}}).then((e=>{this.books=e.data.filter((e=>-1===this.recipe_book_list.indexOf(e))),this.books_loading=!1}))},createBook:function(e){let t=new p.ApiApiFactory;t.createRecipeBook({name:e}).then((e=>{this.books.push(e.data),this.selected_book=e.data,u.StandardToasts.makeStandardToast(this,u.StandardToasts.SUCCESS_CREATE)}))},addToBook:function(){let e=new p.ApiApiFactory;e.createRecipeBookEntry({book:this.selected_book.id,recipe:this.recipe.id}).then((e=>{this.recipe_book_list.push(e.data),u.StandardToasts.makeStandardToast(this,u.StandardToasts.SUCCESS_CREATE)})).catch((e=>{u.StandardToasts.makeStandardToast(this,u.StandardToasts.FAIL_UPDATE,e)}))},removeFromBook:function(e){let t=new p.ApiApiFactory;t.destroyRecipeBookEntry(e.id).then((t=>{this.recipe_book_list=this.recipe_book_list.filter((t=>t.id!==e.id)),u.StandardToasts.makeStandardToast(this,u.StandardToasts.SUCCESS_DELETE)}))},loadBookEntries:function(){let e=new p.ApiApiFactory;e.listRecipeBookEntrys({query:{recipe:this.recipe.id}}).then((e=>{this.recipe_book_list=e.data,this.loadBooks("")}))}}},h=_,f=i(1001),g=(0,f.Z)(h,a,s,!1,null,null,null),m=g.exports},76292:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return f}});var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("b-modal",{attrs:{"hide-footer":"",id:"shopping_"+this.modal_id,"body-class":"p-3 pt-0 pt-md-3"},on:{show:e.loadRecipe},scopedSlots:e._u([{key:"modal-title",fn:function(){return[i("h5",[e._v(e._s(e.$t("Add_Servings_to_Shopping",{servings:e.recipe_servings})))])]},proxy:!0}])},[e.loading?i("loading-spinner"):e._e(),e.loading?e._e():i("div",{staticClass:"accordion",attrs:{role:"tablist"}},[i("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[i("b-card-header",{staticClass:"p-0",attrs:{"header-tag":"header",role:"tab"}},[i("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.accordion-0",modifiers:{"accordion-0":!0}}],staticClass:"text-left",attrs:{block:"",variant:"outline-info"}},[e._v(e._s(e.recipe.name))])],1),i("b-collapse",{staticClass:"p-2",attrs:{id:"accordion-0",visible:"",accordion:"my-accordion",role:"tabpanel"}},[i("ingredients-card",{attrs:{steps:e.steps,recipe:e.recipe.id,ingredient_factor:e.ingredient_factor,servings:e.recipe_servings,add_shopping_mode:!0,recipe_list:e.list_recipe,header:!1},on:{"add-to-shopping":function(t){return e.addShopping(t)},"starting-cart":function(t){e.add_shopping=t}}})],1),e._l(e.related_recipes,(function(t){return[i("b-card",{key:t.recipe.id,staticClass:"mb-1",attrs:{"no-body":""}},[i("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[i("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"accordion-"+t.recipe.id,expression:"'accordion-' + r.recipe.id"}],staticClass:"text-left",attrs:{"btn-sm":"",block:"",variant:"outline-primary"}},[e._v(e._s(t.recipe.name))])],1),i("b-collapse",{attrs:{id:"accordion-"+t.recipe.id,accordion:"my-accordion",role:"tabpanel"}},[i("ingredients-card",{attrs:{steps:t.steps,recipe:t.recipe.id,ingredient_factor:e.ingredient_factor,servings:e.recipe_servings,add_shopping_mode:!0,recipe_list:e.list_recipe,header:!1},on:{"add-to-shopping":function(t){return e.addShopping(t)},"starting-cart":function(t){e.add_shopping=e.add_shopping.concat(t)}}})],1)],1)]}))],2)],1),i("div",[i("b-input-group",[i("b-input-group-prepend",{staticClass:"d-inline-flex",attrs:{"is-text":""}},[i("i",{staticClass:"fa fa-calculator"})]),i("b-form-spinbutton",{staticStyle:{height:"3em"},attrs:{min:"1",inline:""},model:{value:e.recipe_servings,callback:function(t){e.recipe_servings=t},expression:"recipe_servings"}}),i("b-input-group-append",{staticClass:"d-inline-flex"},[i("b-button",{staticClass:"d-none d-lg-inline-block",attrs:{variant:"success"},on:{click:e.saveShopping}},[e._v(e._s(e.$t("Save"))+" ")]),i("b-button",{staticClass:"d-inline-block d-lg-none",attrs:{variant:"success"},on:{click:e.saveShopping}},[i("i",{staticClass:"fa fa-cart-plus"})])],1)],1)],1)],1)],1)},s=[],n=i(70538),r=i(56738),o=i(4222),l=i(21658),d=i(57609);n["default"].use(r.XG7);const{ApiApiFactory:c}=i(70846);var p={name:"ShoppingModal",components:{IngredientsCard:l["default"],LoadingSpinner:d["default"]},mixins:[],props:{recipe:{required:!0,type:Object},servings:{type:Number,default:void 0},modal_id:{required:!0,type:Number},mealplan:{type:Number,default:void 0},list_recipe:{type:Number,default:void 0}},data(){return{loading:!0,steps:[],recipe_servings:void 0,add_shopping:[],related_recipes:[]}},mounted(){this.recipe_servings=this.servings},computed:{ingredient_factor:function(){return this.recipe_servings/this.recipe.servings}},watch:{servings:function(e){this.recipe_servings=parseInt(e)}},methods:{loadRecipe:function(){this.add_shopping=[],this.related_recipes=[];let e=new c;e.retrieveRecipe(this.recipe.id).then((e=>{this.steps=e.data.steps,this.recipe_servings||(this.recipe_servings=e.data?.servings),this.loading=!1})).then((()=>{e.relatedRecipe(this.recipe.id).then((e=>e.data)).then((t=>{let i=[];return t.forEach((t=>{i.push(e.listSteps(t.id).then((e=>{this.related_recipes.push({recipe:t,steps:e.data.results.filter((e=>e.ingredients.length>0))})})))})),Promise.all(i)}))}))},addShopping:function(e){e.add?this.add_shopping.push(e.item.id):this.add_shopping=this.add_shopping.filter((t=>t!==e.item.id))},saveShopping:function(){let e={id:this.recipe.id,ingredients:this.add_shopping,servings:this.recipe_servings,mealplan:this.mealplan,list_recipe:this.list_recipe},t=new c;t.shoppingRecipe(this.recipe.id,e).then((e=>{o.StandardToasts.makeStandardToast(this,o.StandardToasts.SUCCESS_CREATE),this.$emit("finish")})).catch((e=>{o.StandardToasts.makeStandardToast(this,o.StandardToasts.FAIL_CREATE,e)})),this.$bvModal.hide(`shopping_${this.modal_id}`)}}},u=p,_=i(1001),h=(0,_.Z)(u,a,s,!1,null,null,null),f=h.exports},50817:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return v}});var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.recipe&&e.recipe.loading?[i("b-card",{directives:[{name:"hover",rawName:"v-hover"}],attrs:{"no-body":""}},[i("b-card-img-lazy",{staticStyle:{height:"15vh","object-fit":"cover"},attrs:{src:e.placeholder_image,alt:e.$t("Recipe_Image"),top:""}}),i("b-card-body",{staticClass:"p-4"},[i("h6",[i("b-skeleton",{attrs:{width:"95%"}})],1),i("b-card-text",[i("b-skeleton",{attrs:{height:"12px",width:(45+45*Math.random()).toString()+"%"}}),i("b-skeleton",{attrs:{height:"12px",width:(20+25*Math.random()).toString()+"%"}}),i("b-skeleton",{attrs:{height:"12px",width:(30+35*Math.random()).toString()+"%"}})],1)],1)],1)]:[e.recipe?i("b-card",{directives:[{name:"hover",rawName:"v-hover"}],attrs:{"no-body":""}},[i("a",{attrs:{href:void 0!==this.recipe.id?e.resolveDjangoUrl("view_recipe",this.recipe.id):null}},[i("b-card-img-lazy",{staticStyle:{height:"15vh","object-fit":"cover"},attrs:{src:e.recipe_image,alt:e.$t("Recipe_Image"),top:""}}),e.show_context_menu?i("div",{staticClass:"card-img-overlay h-100 d-flex flex-column justify-content-right float-right text-right pt-2 pr-1"},[i("a",[null!==e.recipe?i("recipe-context-menu",{staticClass:"float-right",attrs:{recipe:e.recipe,disabled_options:e.context_disabled_options}}):e._e()],1)]):e._e(),0!==e.recipe.working_time||0!==e.recipe.waiting_time?i("div",{staticClass:"card-img-overlay w-50 d-flex flex-column justify-content-left float-left text-left pt-2"},[0!==e.recipe.working_time?i("b-badge",{staticClass:"mt-1 font-weight-normal",attrs:{pill:"",variant:"light"}},[i("i",{staticClass:"fa fa-clock"}),e._v(" "+e._s(e.working_time)+" ")]):e._e(),0!==e.recipe.waiting_time?i("b-badge",{staticClass:"mt-1 font-weight-normal",attrs:{pill:"",variant:"secondary"}},[i("i",{staticClass:"fa fa-pause"}),e._v(" "+e._s(e.waiting_time)+" ")]):e._e()],1):e._e()],1),i("b-card-body",{staticClass:"p-4"},[i("h6",[i("a",{attrs:{href:void 0!==this.recipe.id?e.resolveDjangoUrl("view_recipe",this.recipe.id):null}},[null!==e.recipe?[e._v(e._s(e.recipe.name))]:[e._v(e._s(e.meal_plan.title))]],2)]),i("b-card-text",{staticStyle:{"text-overflow":"ellipsis"}},[null!==e.recipe?[i("recipe-rating",{attrs:{recipe:e.recipe}}),null!==e.recipe.description&&void 0!==e.recipe.description?[e.recipe.description.length>e.text_length?i("span",[e._v(" "+e._s(e.recipe.description.substr(0,e.text_length)+"…")+" ")]):e._e(),e.recipe.description.length<=e.text_length?i("span",[e._v(" "+e._s(e.recipe.description)+" ")]):e._e()]:e._e(),i("p",{staticClass:"mt-1"},[i("last-cooked",{attrs:{recipe:e.recipe}}),i("keywords-component",{staticStyle:{"margin-top":"4px",position:"relative","z-index":"3"},attrs:{recipe:e.recipe}})],1),i("transition",{attrs:{name:"fade",mode:"in-out"}},[e.show_detail?i("div",{staticClass:"row mt-3"},[i("div",{staticClass:"col-md-12"},[i("h6",{staticClass:"card-title"},[i("i",{staticClass:"fas fa-pepper-hot"}),e._v(" "+e._s(e.$t("Ingredients"))+" ")]),i("ingredients-card",{attrs:{steps:e.recipe.steps,header:!1,detailed:!1,servings:e.recipe.servings}})],1)]):e._e()]),e.recipe.internal?e._e():i("b-badge",{attrs:{pill:"",variant:"info"}},[e._v(e._s(e.$t("External")))])]:[e._v(e._s(e.meal_plan.note))]],2)],1),void 0!==e.footer_text?i("b-card-footer",[i("i",{class:e.footer_icon}),e._v(" "+e._s(e.footer_text)+" ")]):e._e()],1):e._e()]],2)},s=[],n=i(67664),r=i(33144),o=i(4222),l=i(78924),d=i(30381),c=i.n(d),p=i(70538),u=i(53559),_=i(21658);p["default"].prototype.moment=c();var h={name:"RecipeCard",mixins:[o.ResolveUrlMixin],components:{LastCooked:u["default"],RecipeRating:l["default"],KeywordsComponent:r["default"],"recipe-context-menu":n["default"],IngredientsCard:_["default"]},props:{recipe:Object,meal_plan:Object,footer_text:String,footer_icon:String,detailed:{type:Boolean,default:!0},show_context_menu:{type:Boolean,default:!0},context_disabled_options:Object},data(){return{placeholder_image:window.IMAGE_PLACEHOLDER}},mounted(){},computed:{show_detail:function(){return void 0!==this.recipe?.steps&&this.detailed},text_length:function(){return this.show_detail?200:120},recipe_image:function(){return null==this.recipe||null===this.recipe.image?window.IMAGE_PLACEHOLDER:this.recipe.image},working_time:function(){return(0,o.calculateHourMinuteSplit)(this.recipe.working_time)},waiting_time:function(){return(0,o.calculateHourMinuteSplit)(this.recipe.waiting_time)}},methods:{},directives:{hover:{inserted:function(e){e.addEventListener("mouseenter",(()=>{e.classList.add("shadow")})),e.addEventListener("mouseleave",(()=>{e.classList.remove("shadow")}))}}}},f=h,g=i(1001),m=(0,g.Z)(f,a,s,!1,null,"4ac566a2",null),v=m.exports},67664:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return k}});var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"dropdown d-print-none"},[e._m(0),i("div",{staticClass:"dropdown-menu dropdown-menu-right",attrs:{"aria-labelledby":"dropdownMenuLink"}},[e.disabled_options.edit?e._e():i("a",{staticClass:"dropdown-item",attrs:{href:e.resolveDjangoUrl("edit_recipe",e.recipe.id)}},[i("i",{staticClass:"fas fa-pencil-alt fa-fw"}),e._v(" "+e._s(e.$t("Edit")))]),e.recipe.internal||e.disabled_options.convert?e._e():i("a",{staticClass:"dropdown-item",attrs:{href:e.resolveDjangoUrl("edit_convert_recipe",e.recipe.id)}},[i("i",{staticClass:"fas fa-exchange-alt fa-fw"}),e._v(" "+e._s(e.$t("convert_internal")))]),i("a",{attrs:{href:"javascript:void(0);"}},[e.disabled_options.books?e._e():i("button",{staticClass:"dropdown-item",on:{click:function(t){return e.$bvModal.show("id_modal_add_book_"+e.modal_id)}}},[i("i",{staticClass:"fas fa-bookmark fa-fw"}),e._v(" "+e._s(e.$t("Manage_Books"))+" ")])]),e.recipe.internal&&!e.disabled_options.shopping?i("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:e.addToShopping}},[i("i",{staticClass:"fas fa-shopping-cart fa-fw"}),e._v(" "+e._s(e.$t("Add_to_Shopping"))+" ")]):e._e(),e.disabled_options.plan?e._e():i("a",{staticClass:"dropdown-item",attrs:{href:"javascript:void(0);"},on:{click:e.createMealPlan}},[i("i",{staticClass:"fas fa-calendar fa-fw"}),e._v(" "+e._s(e.$t("Add_to_Plan"))+" ")]),i("a",{attrs:{href:"javascript:void(0);"}},[e.disabled_options.log?e._e():i("button",{staticClass:"dropdown-item",on:{click:function(t){return e.$bvModal.show("id_modal_cook_log_"+e.modal_id)}}},[i("i",{staticClass:"fas fa-clipboard-list fa-fw"}),e._v(" "+e._s(e.$t("Log_Cooking"))+" ")])]),i("a",{attrs:{href:"javascript:void(0);"}},[e.disabled_options.print?e._e():i("button",{staticClass:"dropdown-item",attrs:{onclick:"window.print()"}},[i("i",{staticClass:"fas fa-print fa-fw"}),e._v(" "+e._s(e.$t("Print"))+" ")])]),i("a",{attrs:{href:"javascript:void(0);"}},[e.disabled_options.copy?e._e():i("button",{staticClass:"dropdown-item",on:{click:e.copyToNew}},[i("i",{staticClass:"fas fa-copy fa-fw"}),e._v(" "+e._s(e.$t("copy_to_new"))+" ")])]),e.disabled_options.export?e._e():i("a",{staticClass:"dropdown-item",attrs:{href:e.resolveDjangoUrl("view_export")+"?r="+e.recipe.id,target:"_blank",rel:"noopener noreferrer"}},[i("i",{staticClass:"fas fa-file-export fa-fw"}),e._v(" "+e._s(e.$t("Export")))]),i("a",{attrs:{href:"javascript:void(0);"}},[e.disabled_options.pin?e._e():i("button",{staticClass:"dropdown-item",on:{click:function(t){return e.pinRecipe()}}},[i("i",{staticClass:"fas fa-thumbtack fa-fw"}),e._v(" "+e._s(e.$t("Pin"))+" ")])]),i("a",{attrs:{href:"javascript:void(0);"}},[e.recipe.internal&&!e.disabled_options.share?i("button",{staticClass:"dropdown-item",on:{click:function(t){return e.createShareLink()}}},[i("i",{staticClass:"fas fa-share-alt fa-fw"}),e._v(" "+e._s(e.$t("Share"))+" ")]):e._e()])])]),i("cook-log",{attrs:{recipe:e.recipe,modal_id:e.modal_id}}),i("add-recipe-to-book",{attrs:{recipe:e.recipe,modal_id:e.modal_id,entryEditing_inital_servings:e.servings_value}}),i("shopping-modal",{attrs:{recipe:e.recipe,servings:e.servings_value,modal_id:e.modal_id,mealplan:void 0}}),i("b-modal",{attrs:{id:"modal-share-link_"+e.modal_id,title:e.$t("Share"),"hide-footer":""}},[i("div",{staticClass:"row"},[i("div",{staticClass:"col col-md-12"},[void 0!==e.recipe_share_link?i("label",[e._v(e._s(e.$t("Public share link")))]):e._e(),i("input",{directives:[{name:"model",rawName:"v-model",value:e.recipe_share_link,expression:"recipe_share_link"}],ref:"share_link_ref",staticClass:"form-control",domProps:{value:e.recipe_share_link},on:{input:function(t){t.target.composing||(e.recipe_share_link=t.target.value)}}}),i("b-button",{staticClass:"mt-2 mb-3 d-none d-md-inline",attrs:{variant:"secondary"},on:{click:function(t){return e.$bvModal.hide("modal-share-link_"+e.modal_id)}}},[e._v(e._s(e.$t("Close"))+" ")]),i("b-button",{staticClass:"mt-2 mb-3 ml-md-2",attrs:{variant:"primary"},on:{click:function(t){return e.copyShareLink()}}},[e._v(e._s(e.$t("Copy"))+" ")]),i("b-button",{staticClass:"mt-2 mb-3 ml-2 float-right",attrs:{variant:"success"},on:{click:function(t){return e.shareIntend()}}},[e._v(e._s(e.$t("Share"))+" "),i("i",{staticClass:"fa fa-share-alt"})])],1)])]),i("meal-plan-edit-modal",{attrs:{entry:e.entryEditing,entryEditing_inital_servings:e.servings_value,modal_id:"modal-meal-plan_"+e.modal_id,allow_delete:!1,modal_title:e.$t("Create_Meal_Plan_Entry")},on:{"save-entry":e.saveMealPlan}})],1)},s=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a",{staticClass:"btn shadow-none",attrs:{href:"javascript:void(0);",role:"button",id:"dropdownMenuLink","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[i("i",{staticClass:"fas fa-ellipsis-v fa-lg"})])}],n=i(4222),r=i(61348),o=i(9669),l=i.n(o),d=i(14551),c=i(23737),p=i(76292),u=i(30381),_=i.n(u),h=i(70538),f=i(70846);h["default"].prototype.moment=_();var g={name:"RecipeContextMenu",mixins:[n.ResolveUrlMixin],components:{AddRecipeToBook:d["default"],CookLog:r["default"],MealPlanEditModal:c["default"],ShoppingModal:p["default"]},data(){return{servings_value:0,recipe_share_link:void 0,modal_id:Math.round(1e5*Math.random()),options:{entryEditing:{date:null,id:-1,meal_type:null,note:"",note_markdown:"",recipe:null,servings:1,shared:[],title:"",title_placeholder:this.$t("Title")}},entryEditing:{},mealplan:void 0}},props:{recipe:Object,servings:{type:Number,default:-1},disabled_options:{type:Object,default:()=>({print:!0})}},mounted(){this.servings_value=-1===this.servings?this.recipe.servings:this.servings},watch:{recipe:{handler(){},deep:!0},servings:function(e){this.servings_value=parseInt(e)}},methods:{pinRecipe:function(){let e=JSON.parse(localStorage.getItem("pinned_recipes"))||[];e.push({id:this.recipe.id,name:this.recipe.name}),localStorage.setItem("pinned_recipes",JSON.stringify(e))},saveMealPlan:function(e){e.date=_()(e.date).format("YYYY-MM-DD");let t=e.addshopping&&e.reviewshopping;e.addshopping=e.addshopping&&!e.reviewshopping;let i=new f.ApiApiFactory;i.createMealPlan(e).then((e=>{this.$bvModal.hide(`modal-meal-plan_${this.modal_id}`),t&&(this.mealplan=e.data.id,this.servings_value=e.data.servings,this.addToShopping()),n.StandardToasts.makeStandardToast(this,n.StandardToasts.SUCCESS_CREATE)})).catch((e=>{n.StandardToasts.makeStandardToast(this,n.StandardToasts.FAIL_CREATE,e)}))},createMealPlan(e){this.entryEditing=this.options.entryEditing,this.entryEditing.recipe=this.recipe,this.entryEditing.date=_()(new Date).format("YYYY-MM-DD"),this.$nextTick((function(){this.$bvModal.show(`modal-meal-plan_${this.modal_id}`)}))},createShareLink:function(){console.log("create"),l().get((0,n.resolveDjangoUrl)("api_share_link",this.recipe.id)).then((e=>{console.log("success"),this.$bvModal.show(`modal-share-link_${this.modal_id}`),this.recipe_share_link=e.data.link})).catch((e=>{console.log("fail"),403===e.response.status&&(0,n.makeToast)(this.$t("Share"),this.$t("Sharing is not enabled for this space or your user account."),"danger")}))},copyShareLink:function(){let e=this.$refs.share_link_ref;e.select(),document.execCommand("copy")},shareIntend:function(){let e={title:this.recipe.name,text:`${this.$t("Check out this recipe: ")} ${this.recipe.name}`,url:this.recipe_share_link};navigator.share(e)},addToShopping(){this.$bvModal.show(`shopping_${this.modal_id}`)},copyToNew:function(){let e=window.prompt(this.$t("copy_to_new"),this.$t("recipe_name")),t=new f.ApiApiFactory;t.retrieveRecipe(this.recipe.id).then((i=>{let a={...i.data,id:void 0,name:e};a.steps=a.steps.map((e=>({...e,id:void 0,ingredients:e.ingredients.map((e=>({...e,id:void 0})))}))),null!==a.nutrition&&delete a.nutrition.id,t.createRecipe(a).then((e=>{n.StandardToasts.makeStandardToast(this,n.StandardToasts.SUCCESS_CREATE),window.open(this.resolveDjangoUrl("view_recipe",e.data.id))})).catch((e=>{n.StandardToasts.makeStandardToast(this,n.StandardToasts.FAIL_CREATE,e)}))}))}}},m=g,v=i(1001),b=(0,v.Z)(m,a,s,!1,null,null,null),k=b.exports},78924:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return d}});var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.recipe.rating>0?i("span",{staticClass:"d-inline"},[e._l(Math.floor(e.recipe.rating),(function(e){return i("i",{key:e,staticClass:"fas fa-star fa-xs text-primary"})})),e.recipe.rating%1>0?i("i",{staticClass:"fas fa-star-half-alt fa-xs text-primary"}):e._e(),e._l(5-Math.ceil(e.recipe.rating),(function(e){return i("i",{key:e+10,staticClass:"far fa-star fa-xs text-secondary"})}))],2):e._e()])},s=[],n={name:"RecipeRating",props:{recipe:Object}},r=n,o=i(1001),l=(0,o.Z)(r,a,s,!1,null,"7cf9259e",null),d=l.exports},82093:function(e,t,i){"use strict";var a=i(78066);t["Z"]=a.Z},22291:function(e,t,i){"use strict";i.d(t,{s:function(){return a},x:function(){return s}});var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"row"},[i("div",{staticClass:"col",staticStyle:{"text-align":"center"}},[i("img",{staticClass:"spinner-tandoor",style:{height:e.size+"vh"},attrs:{alt:"loading spinner",src:""}})])])},s=[]},78066:function(e,t){"use strict";t["Z"]={name:"LoadingSpinner",props:{recipe:Object,size:{type:Number,default:30}}}},57871:function(e,t,i){"use strict";i.d(t,{YI:function(){return o},vp:function(){return r}});var a=i(9669),s=i.n(a),n=i(4222);i(70846);function r(e){let t=(0,n.resolveDjangoUrl)("api:recipe-detail",e);return void 0!==window.SHARE_UID&&"None"!==window.SHARE_UID&&(t+="?share="+window.SHARE_UID),s().get(t).then((e=>e.data)).catch((e=>{l(e,"There was an error loading a resource!","danger")}))}function o(e){return s().post((0,n.resolveDjangoUrl)("api:cooklog-list"),e).then((e=>{(0,n.makeToast)("Saved","Cook Log entry saved!","success")})).catch((e=>{l(e,"There was an error creating a resource!","danger")}))}function l(e,t){if("response"in e){console.log(e.response);let i="statusText"in e.response?e.response.statusText:(0,n.djangoGettext)("Error");t+="\n\n"+JSON.stringify(e.response.data),(0,n.makeToast)(i,t,"danger")}else(0,n.makeToast)("Error",t,"danger"),console.log(e)}s().defaults.xsrfCookieName="csrftoken",s().defaults.xsrfHeaderName="X-CSRFTOKEN"},22868:function(){},14777:function(){},99830:function(){},70209:function(){},87414:function(){}}]);